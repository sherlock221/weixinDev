function checkNum(e){var t=/^\d+$/;return t.test(e)?!0:!1}Zepto(function(e){function t(e){var t=parseFloat(e);if(isNaN(t))return console.log("function:changeTwoDecimal->parameter error"),!1;var t=Math.round(100*e)/100;return t}var a=lg.get("orderMsgs"),s=a,r=0,n=0;for(i=0;void 0!=s.products[i];i++){var o=e("<li />",{"class":"fooditem"}),l=e("<div />",{text:s.products[i].PName,"class":"dingdan"}),p=e("<div />",{text:s.products[i].PName,"class":"dingdan_fullname",style:"display:none"}),d=e("<a />",{"class":"fuhaowai"}),u=e("<span />",{type:"text","class":"shuliang",text:s.products[i].buyCount,name:s.products[i].buyCount}),c=e("<img />",{"class":"fuhao jian",src:"/funweb/img/minus.png"}),m=e("<img />",{"class":"fuhao jia",src:"/funweb/img/plus.png"}),f=e("<a />",{"class":"fuhaowai"}),g=e("<div />",{"class":"xuanze",css:{display:"block","float":"right","margin-right":"5px"}}),v=e("<span />",{text:s.products[i].PPrice+"元",css:{"float":"right",width:"50px","text-align":"center"},"class":"dingdan danjia"});f.append(m),d.append(c),g.append(f,u,d),o.append(l,p,g,v),e(".food_cart").append(o),r+=s.products[i].buyCount*s.products[i].PPrice,n+=1*s.products[i].buyCount}var h=e("<li>",{"class":"fooditem",id:"delivery_fee"}).appendTo(".food_cart");h.append(e("<span>",{"class":"item_title",text:"配送费"})),r=parseFloat(r)+parseFloat(s.supplier.deliveryCharge),h.append(e("<span>",{"class":"foodprice",text:s.supplier.deliveryCharge+"元"})),e("#submoney").text(r),e("#ms").text(n),a.totalPrice=r-0,lg.save("orderMsgs",a),e("#back").bind("click",function(){history.go(-1)}),e(".shuliang").bind("change",function(){if(!checkNum(e(this).val()))return alert("菜品数量必须为正整数！"),e(this).val(e(this).attr("name")),!1;var t=e(this),a=parseFloat(e("#submoney").text()),s=t.parents(".fooditem"),r=parseFloat(s.find(".danjia").text().substring(0,s.find(".danjia").text().length-1));a+=(parseInt(t.val())-parseInt(t.attr("name")))*r,e("#submoney").text(a.toFixed(1));var n=e("#ms").text();n=parseInt(n)+(parseInt(t.val())-parseInt(t.attr("name"))),e("#ms").text(n),t.attr("name",t.val())}),e(".btn_100").bind("click",function(){for(var t=parseFloat(e("#submoney").text()),a=JSON.stringify(lg.get("orderMsgs")),s=e(".fooditem"),r=0;s.length-1>r;r++){var n=s[r],i=e(n).find(".shuliang").text();if(!checkNum(i))return alert("菜品数量必须为正整数！"),!1}if(parseFloat(a.supplier.deliveryLeastValue)+parseFloat(a.supplier.deliveryCharge)>t)return alert("起送价为"+a.supplier.deliveryLeastValue),!1;for(var r=0;s.length-1>r;r++){var n=s[r],i=e(n).find(".shuliang").text();a.products[r].buyCount=i}var o=parseFloat(e("#submoney").text()),l=parseInt(e("#ms").text());a.totalQuantity=l,a.totalAmount=o,lg.save("orderMsgs",JSON.parse(a))}),e(".jia").bind("click",function(){var a=e(this).parents(".xuanze").find("span").text(),s=parseInt(a);e(this).parents(".xuanze").find("span").text(s+1);var r=e("#ms").text();e("#ms").text(1*r+1);var n=t(e(this).parents(".fooditem").find(".danjia").text().replace(/[^0-9\.]/gi,"")),i=e("#submoney").text();e("#submoney").text(t(1*i+1*n))}),e(".jian").bind("click",function(){var a=e(this).parents(".xuanze").find("span").text();if(1*a>0){var s=parseInt(a);e(this).parents(".xuanze").find("span").text(s-1);var r=e("#ms").text();e("#ms").text(1*r-1);var n=t(e(this).parents(".fooditem").find(".danjia").text().replace(/[^0-9\.]/gi,"")),i=e("#submoney").text();e("#submoney").text(t(1*i-1*n))}})});